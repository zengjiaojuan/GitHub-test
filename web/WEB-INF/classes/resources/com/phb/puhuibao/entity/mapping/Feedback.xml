<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper 
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.phb.puhuibao.entity.Feedback">
    <resultMap id="Feedback" type="com.phb.puhuibao.entity.Feedback">
   	    <result property="feedbackId" column="feedback_id" jdbcType="INTEGER"/>
   	    <result property="content" column="content" jdbcType="LONGVARCHAR"/>
   	    <result property="createTime" column="create_time" jdbcType="TIMESTAMP"/>
    	<result property="mUserId" column="m_user_id" jdbcType="INTEGER" />
	</resultMap>

	<sql id="queryBody">
		<if test="sno!=null and eno!=null and orderBy!=null">
 	    	select <include refid="allColumn"/> from phb_feedback <include refid="dynamicWhere"/>
			<include refid="dynamicOrderBy" />
			limit ${sno-1},${eno}
		</if>
	</sql>	

 	<select id="query" parameterType="java.util.Map" resultMap="Feedback">
 	    select <include refid="allColumn"/> from phb_feedback <include refid="dynamicWhere"/>
	</select>
	<select id="findByPager" parameterType="java.util.Map" resultMap="Feedback">
		<include refid="queryBody" />
	</select>
	<select id="findByPagerCount" parameterType="java.util.Map" resultType="int" >
		select count(1) from phb_feedback
		<include refid="dynamicWhere" />
	</select>
	<select id="unique" parameterType="java.util.Map" resultMap="Feedback" >
 	    select <include refid="allColumn"/> from phb_feedback <include refid="dynamicWhere"/> limit 1
	</select>
	<select id="getById" parameterType="java.util.Map" resultMap="Feedback">
 	    select <include refid="allColumn"/> from phb_feedback where feedback_id=#{feedbackId}
	</select>

 	<sql id="dynamicWhere">
		<trim prefix="WHERE" prefixOverrides="AND|OR">
			<if test="id!=null">
				and feedback_id = #{feedbackId}
			</if>
		</trim>
	</sql>
 
	<sql id="dynamicOrderBy">
		<if test="orderBy!=null">
			order by ${orderBy}
			<if test="order!=null">
				${order}
		</if>
		</if>
	</sql>
	<sql id="allColumn">
	    feedback_id,content,create_time,m_user_id
	</sql>
	<sql id="allapplColumn">
	    feedback_id,content,m_user_id
	</sql>
	<sql id="allapplColumnVar">
		values(
			#{feedbackId,jdbcType=INTEGER},
			#{content,jdbcType=LONGVARCHAR},
			#{mUserId,jdbcType=VARCHAR}
	     )
	</sql>

	<insert id="insert" parameterType="com.phb.puhuibao.entity.Feedback" >
	    insert into phb_feedback(<include refid="allapplColumn"/>) <include refid="allapplColumnVar"/>
	</insert>
	
	<delete id="delete" parameterType="java.util.Map">
		delete from phb_feedback where feedback_id=${id}
	</delete>
</mapper>